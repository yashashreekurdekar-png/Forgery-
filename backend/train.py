import os\nimport numpy as np\nimport tensorflow as tf\nfrom tensorflow import keras\nfrom tensorflow.keras import layers\n\n# Load ELA processed images\ndef load_images_from_folder(folder):\n    images = []\n    for filename in os.listdir(folder):\n        img = keras.preprocessing.image.load_img(os.path.join(folder, filename), target_size=(128, 128))\n        img_array = keras.preprocessing.image.img_to_array(img)\n        images.append(img_array)\n    return np.array(images)\n\n# Preprocessing images\nfolder_path = 'path_to_ela_processed_images'  # specify the path to your ELA processed images\nimages = load_images_from_folder(folder_path)\nimages = images / 255.0  # normalize images\nlabels = np.array([0] * (len(images) // 2) + [1] * (len(images) // 2))  # binary labels for example\n\n# Define CNN model\ndef create_model():\n    model = keras.Sequential([\n        layers.Conv2D(32, (3, 3), activation='relu', input_shape=(128, 128, 3)),\n        layers.MaxPooling2D((2, 2)),\n        layers.Conv2D(64, (3, 3), activation='relu'),\n        layers.MaxPooling2D((2, 2)),\n        layers.Conv2D(128, (3, 3), activation='relu'),\n        layers.MaxPooling2D((2, 2)),\n        layers.Flatten(),\n        layers.Dense(128, activation='relu'),\n        layers.Dense(1, activation='sigmoid')\n    ])\n    return model\n\n# Compile and train the model\nmodel = create_model()\nmodel.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])\n\n# Split data into training and validation sets\nfrom sklearn.model_selection import train_test_split\nX_train, X_val, y_train, y_val = train_test_split(images, labels, test_size=0.2, random_state=42)\n\n# Train the model\nmodel.fit(X_train, y_train, epochs=10, validation_data=(X_val, y_val))\n\n# Save the model\nmodel.save('cnn_model.h5')\n