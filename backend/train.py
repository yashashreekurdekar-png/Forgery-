import tensorflow as tf\nfrom tensorflow.keras import layers, models\nimport numpy as np\nimport os\n\n# Function to load and preprocess dataset\ndef load_data(data_dir):\n    images = []\n    labels = []\n    for label in os.listdir(data_dir):\n        label_dir = os.path.join(data_dir, label)\n        for img_file in os.listdir(label_dir):\n            img_path = os.path.join(label_dir, img_file)\n            img = tf.keras.preprocessing.image.load_img(img_path, target_size=(128, 128))\n            img_array = tf.keras.preprocessing.image.img_to_array(img)\n            images.append(img_array)\n            labels.append(label)\n    return np.array(images), np.array(labels)\n\n# Load data\ntrain_images, train_labels = load_data('path/to/train_data')\n\n# Normalize images\ntrain_images = train_images / 255.0\n\n# Define CNN model\nmodel = models.Sequential([\n    layers.Conv2D(32, (3, 3), activation='relu', input_shape=(128, 128, 3)),\n    layers.MaxPooling2D((2, 2)),\n    layers.Conv2D(64, (3, 3), activation='relu'),\n    layers.MaxPooling2D((2, 2)),\n    layers.Conv2D(128, (3, 3), activation='relu'),\n    layers.MaxPooling2D((2, 2)),\n    layers.Flatten(),\n    layers.Dense(128, activation='relu'),\n    layers.Dense(1, activation='sigmoid')\n])\n\n# Compile model\nmodel.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])\n\n# Train model\nmodel.fit(train_images, train_labels, epochs=10, validation_split=0.2)\n\n# Save model\nmodel.save('forgery_detection_model.h5')\n